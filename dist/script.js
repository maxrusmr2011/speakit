!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t,r){return(s=c()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&u(o,r.prototype),o}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!(this instanceof l?this.constructor:void 0))return s(l,r);var a=r[0],i=r[1],c=r[2];if(this.native="string"==typeof a?document.createElement(a):a,i){var u,d=i.split(" ");(u=this.native.classList).add.apply(u,o(d))}c&&("string"==typeof c?this.native.innerHTML=c:Array.isArray(c)?c.forEach((function(t){e.native.append(t.native?t.native:t)})):this.native.append(c.native?c.native:c))}function d(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}l.prototype.attr=function(e){var t=this;return e.forEach((function(e){var r=n(e,2),o=r[0],a=r[1];t.native.setAttribute(o,a)})),this},l.prototype.prop=function(e){var t=this;return e.forEach((function(e){var r=n(e,2),o=r[0],a=r[1];t.native[o]=a})),this},l.prototype.on=function(e,t){return this.native.addEventListener(e,t),this};var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,(r=[{key:"init",value:function(){var e=this,t=document.querySelector(".game__level");t.addEventListener("click",(function(t){var r;t.target.classList.contains("level")&&(d(t.currentTarget.children).forEach((function(e,n){e===t.target&&(r=n)})),r!==window.app.game.groupWords&&(e.changeLevel(r),window.app.game.changeGroup(r)))}));for(var r=0;r<6;r+=1)t.append(l("div","level".concat(window.app.game.groupWords===r?" level-active":""),"".concat(r+1)).native)}},{key:"changeLevel",value:function(e){var t=this;d(document.querySelector(".game__level").children).forEach((function(r,n){n===e?(r.classList.add("level-active"),t.level=n):r.classList.remove("level-active")}))}}])&&h(t.prototype,r),n&&h(t,n),e}();function m(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentPage=0,this.levelWidget=new f}var t,r,n;return t=e,(r=[{key:"init",value:function(){this.page0(),this.page1(),this.page2(),this.levelWidget.init(),window.app.game.nullGame()}},{key:"page0",value:function(){var e=l("h1","start__title","SPEAK IT"),t=l("p","start__text","Click on the words to hear them sound.<br>Click on the button and speak the words into the microphone."),r=l("button","start__btn","START"),n=l("div","start",[e,t,r]),o=document.querySelector(".header");o.append(n.native),r.on("click",(function(){o.classList.add("hide"),document.querySelector(".page1").classList.remove("hide")}))}},{key:"page1",value:function(){var e=this,t=l("div","game__level"),r=l("div","game__star"),n=l("div","game__image",l("img").prop([["src","./src/assets/img/blank.jpg"],["alt","image"]])),o=l("div","game__translate"),a=l("img","speech__mic").prop([["src","./src/assets/img/microphone.png"],["alt","mic"]]),i=l("input","speech__text").attr([["placeholder","Speak word..."],["readonly",""]]),s=l("div","game__speech",[a,i]),c=l("div","game__content",[n,o,s]),u=l("div","game__words"),d=l("button","btn btn-start","Start train").on("click",(function(){window.app.game.startTrain()})),p=l("button","btn btn-speak","Speak").on("click",(function(){window.app.game.startedTrain&&window.app.game.startSpeech()})),h=l("button","btn btn-result","Result").on("click",(function(){e.listResults(),document.querySelector(".page1").classList.add("hide"),document.querySelector(".page2").classList.remove("hide"),window.app.game.currentSpeech.stop()})),f=l("button","btn btn-next","Next words").on("click",(function(){window.app.game.nullGame(),window.app.game.nextListWords()})),m=l("div","game__buttons",[d,p,h,f]),v=l("div","game",[t,r,c,u,m]);document.querySelector(".page1").append(v.native)}},{key:"showListWords",value:function(){var e=this,t=window.app.game.currentListWords.map((function(t){var r=l("img","icon-sound").prop([["src","./src/assets/img/sound.png"],["alt","sound"]]),n=l("div",!1,t.word),o=l("div",!1,t.transcription);return l("button","btn-word",[r,n,o]).on("click",(function(){window.app.game.startedTrain&&!window.app.game.startedSpeech&&(e.showImage(t.image),e.sound(t.audio),e.showTranslate(t.word,(function(e){document.querySelector(".game__translate").innerHTML=e})))})).native})),r=document.querySelector(".game__words");r.innerHTML="",r.append.apply(r,m(t))}},{key:"sound",value:function(e){var t="./src/assets/".concat(e);new Audio(t).play()}},{key:"showImage",value:function(e){var t="./src/assets/".concat(e);document.querySelector(".game__image img").src=t}},{key:"showStar",value:function(e){document.querySelector(".game__star").append(l("div","star star-".concat(e?"success":"fail")).native)}},{key:"showTranslate",value:function(e,t){var r="".concat("https://translate.yandex.net/api/v1.5/tr.json/translate","?key=").concat("trnsl.1.1.20200422T111801Z.e0d39b73a715a384.a2a2b921649e23f209f29f7200aebd93340f4270","&text=").concat(e,"&lang=").concat("en-ru");fetch(r).then((function(e){return e.json()})).then((function(e){var r=e.text[0];t(r)}))}},{key:"page2",value:function(){var e=l("div","result__title","Результаты тренировки"),t=l("div","result__words"),r=l("button","btn","RETURN").on("click",(function(){document.querySelector(".page1").classList.remove("hide"),document.querySelector(".page2").classList.add("hide")})),n=l("div","result__buttons",r),o=l("div","result",[e,t,n]),a=document.querySelector(".page2");a.innerHTML="",a.append(o.native)}},{key:"listResults",value:function(){var e=this,t=[],r=[];window.app.game.currentListWords.forEach((function(n){var o;o=n.mark?r:t;var a=l("div",!1,n.word),i=l("div",!1,n.transcription),s=l("div","line line-".concat(n.mark?"success":"error"),[a,i]).on("click",(function(){e.sound(n.audio)})).native;e.showTranslate(n.word,(function(e){s.append(l("div",!1,e).native)})),o.push(s)}));var n=l("div","result__errors","Не произнесено: <span>".concat(t.length,"</span>")).native,o=l("div","result__success","Правильно произнесено: <span>".concat(r.length,"</span>")).native,a=document.querySelector(".result__words");a.innerHTML="",a.append.apply(a,[n].concat(t,[o],r))}}])&&y(t.prototype,r),n&&y(t,n),e}();function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startedTrain=!1,this.startedSpeech=!1,this.groupWords=0,this.pageWords=0,this.isSecondDecadeWords=!1,this.listWords=[],this.currentListWords=[],this.currentSpeech=null}var t,r,n;return t=e,(r=[{key:"init",value:function(){this.getWords()}},{key:"nextListWords",value:function(){this.isSecondDecadeWords?(this.nullGame(),this.isSecondDecadeWords=!1,this.pageWords+=1,this.pageWords>=30&&(this.pageWords=0,this.groupWords+=1,this.groupWords>=6&&(this.groupWords=0),window.app.page.levelWidget.changeLevel(this.groupWords))):this.isSecondDecadeWords=!0,this.getWords()}},{key:"changeGroup",value:function(e){this.groupWords=e,this.pageWords=0,this.nullGame(),this.getWords()}},{key:"nullGame",value:function(){var e=this;this.startedTrain=!1,this.startedSpeech=!1,document.body.classList.remove("game-start"),document.body.classList.remove("game-speech"),document.querySelector(".game__translate").classList.remove("hide"),document.querySelector(".game__speech").classList.add("hide"),document.querySelector(".game__star").innerHTML="",this.currentSpeech&&(this.currentSpeech.stop(),this.currentSpeech=null,document.querySelectorAll(".btn-word").forEach((function(t,r){t.classList.remove("word-success"),e.currentListWords[r].mark=!1}))),this.showButtons([!0,!1,!1,!0])}},{key:"startTrain",value:function(){var e=this;this.startedTrain=!0,this.startedSpeech=!1,document.body.classList.add("game-start"),document.body.classList.remove("game-speech"),document.querySelector(".game__translate").classList.remove("hide"),document.querySelector(".game__speech").classList.add("hide"),this.currentSpeech&&(this.currentSpeech.stop(),this.currentSpeech=null,document.querySelectorAll(".btn-word").forEach((function(t,r){t.classList.remove("word-success"),e.currentListWords[r].mark=!1}))),document.querySelector(".game__star").innerHTML="",document.querySelector(".game__translate").innerHTML="",this.showButtons([!1,!0,!1,!0])}},{key:"startSpeech",value:function(){this.startedSpeech=!0,document.body.classList.add("game-speech"),document.querySelector(".game__translate").classList.add("hide"),document.querySelector(".game__speech").classList.remove("hide"),this.currentSpeech=this.getSpeechWord(),this.currentSpeech.start(),this.showButtons([!0,!0,!0,!0])}},{key:"checkSpeech",value:function(e){var t=this,r=this.currentListWords.findIndex((function(t){return t.word.toLowerCase()===e.toLowerCase()}));if(-1===r)document.querySelector(".speech__text").classList.add("speech-fail"),window.app.page.showStar();else{if(document.querySelectorAll(".btn-word")[r].classList.add("word-success"),this.currentListWords[r].mark=!0,window.app.page.showStar(!0),window.app.page.showImage(this.currentListWords[r].image),this.checkWin())return this.endSpeech(),!1;document.querySelector(".speech__text").classList.add("speech-success")}return setTimeout((function(){var e=document.querySelector(".speech__text");e.value="",e.classList.remove("speech-success"),e.classList.remove("speech-fail"),t.currentSpeech.start()}),1e3),!0}},{key:"endSpeech",value:function(){this.currentSpeech.stop(),this.showButtons([!0,!1,!0,!0])}},{key:"checkWin",value:function(){return this.currentListWords.every((function(e){return e.mark}))}},{key:"showButtons",value:function(e){var t=w(e,4),r=t[0],n=t[1],o=t[2],a=t[3];document.querySelector(".btn-start").disabled=!r,document.querySelector(".btn-speak").disabled=!n,document.querySelector(".btn-result").disabled=!o,document.querySelector(".btn-next").disabled=!a}},{key:"getWords",value:function(){var e=this,t="https://afternoon-falls-25894.herokuapp.com/words?page=".concat(this.pageWords,"&group=").concat(this.groupWords);this.isSecondDecadeWords?(this.currentListWords=this.listWords.slice(10),this.addMarker(),window.app.page.showListWords()):fetch(t).then((function(e){return e.json()})).then((function(t){e.listWords=t,e.currentListWords=e.listWords.slice(0,10),e.addMarker(),window.app.page.showListWords()}))}},{key:"addMarker",value:function(){this.currentListWords=this.currentListWords.map((function(e){var t=e;return t.mark=!1,t}))}},{key:"getSpeechWord",value:function(){var e=this,t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t)return null;var r=new t;return r.lang="en-US",r.interimResults=!1,r.onresult=function(t){var r=t.results[0][0].transcript;e.showSpeech(r),e.checkSpeech(r)},r.onerror=function(){e.showSpeech("error")},r.onnomatch=function(){e.showSpeech("error")},r}},{key:"showSpeech",value:function(e){document.querySelector(".speech__text").value=e}}])&&S(t.prototype,r),n&&S(t,n),e}();function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=new _,this.page=new g}var t,r,n;return t=e,(r=[{key:"init",value:function(){this.page.init(),this.game.init()}}])&&k(t.prototype,r),n&&k(t,n),e}();window.app=new L,window.app.init()}]);